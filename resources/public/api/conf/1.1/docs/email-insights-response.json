{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Email Insights Response",
  "type": "object",
  "properties": {
    "attribute": {
      "type": "string",
      "examples": [
        "EMAIL"
      ]
    },
    "value": {
      "type": "string",
      "examples": [
        "test@gmail.com"
      ]
    },
    "insights": {
      "type": "object",
      "properties": {
        "risk": {
          "type": "object",
          "properties": {
            "score": {
              "type": "number",
              "minimum": 0,
              "maximum": 100,
              "examples": [
                0.0,
                16.67,
                33.33,
                50.0,
                66.67,
                83.33,
                100.0
              ]
            },
            "reason": {
              "type": "string",
              "enum": ["ON_WATCH_LIST", "NOT_ON_WATCH_LIST"]
            }
          },
          "required": [
            "score",
            "reason"
          ]
        },
        "watchlistData": {
          "type": "object",
          "properties": {
            "isOnWatchlist": {
              "type": "boolean"
            }
          },
          "required": [
            "isOnWatchlist"
          ]
        },
        "graphData": {
          "type": "object",
          "properties": {
            "reasons": {
              "type": "array",
              "items": {
                "type": "string",
                "examples": ["EMAIL john.doe@gmail.com is 3 hops from a something risky. The average EMAIL is 4.7 hops from something risky."]
              }
            },
            "hops": {
              "type": "number",
              "examples": [1.54]
            },
            "avgHops": {
              "type": "number",
              "examples": [1.54]
            }
          },
          "required": [
            "reasons"
          ]
        },
        "relationship": {
          "type": "object",
          "properties": {
            "attributes": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "attribute": {
                    "type": "string",
                    "enum": ["person_full_name", "user_id", "agent_code", "sa_utr", "ct_utr", "paye_ref", "vrn"]
                  },
                  "count": {
                    "type": "number",
                    "minimum": 1,
                    "examples": [1, 2, 100]
                  },
                  "attributeValues": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "value": {
                          "type": "string",
                          "examples": ["John doe"]
                        },
                        "numOfOccurrences": {
                          "type": "number",
                          "minimum": 1,
                          "examples": [1, 2, 100]
                        },
                        "lastSeen": {
                          "type": "string",
                          "examples": ["2025-11-11T14:31:23.083Z"]
                        }
                      },
                      "required": [
                        "value",
                        "numOfOccurrences",
                        "lastSeen"
                      ]
                    }
                  }
                },
                "required": [
                  "attribute",
                  "count",
                  "attributeValues"
                ]
              }
            }
          },
          "required": [
            "attributes"
          ]
        }
      },
      "required": [
        "risk",
        "watchlistData",
        "graphData",
        "relationship"
      ]
    }
  },
  "required": [
    "attribute",
    "value",
    "insights"
  ]
}